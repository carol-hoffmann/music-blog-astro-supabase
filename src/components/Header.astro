---
const navLinks = [
  { href: "/", label: "Home", auth: "any" },
  { href: "/posts", label: "Posts", auth: "any" },
  { href: "/posts/new", label: "New post", auth: "in" },
  { href: "/account", label: "Account", auth: "in" },
  { href: "/login", label: "Login", auth: "out" },
  { href: "/register", label: "Register", auth: "out" },
];

const pathname = Astro.url.pathname;

function isActive(href) {
  if (href === "/") {
    return pathname === "/";
  }

  // página exata
  if (pathname === href) {
    return true;
  }

  // subpáginas SOMENTE se não houver um match mais específico
  return (
    pathname.startsWith(href + "/") &&
    !navLinks.some(
      (l) => l.href !== href && pathname === l.href
    )
  );
}

---

<header class="site-header">
  <nav class="hero-header header-dark">
    <a class="site-title" href="/">SOUNDTALK | Talk Music. Share Sound.</a>

    <div class="header-center">
      <a class="header-logo-link" href="/" aria-label="Home">
        <img class="header-logo" src="/images/logo.png" alt="Music Blog logo" />
      </a>
    </div>

    <div class="header-right">
      <div class="nav-links">
        {navLinks.map((l) => {
          const active = isActive(l.href);
          return (
            <a
              href={l.href}
              data-auth={l.auth}
              aria-current={active ? "page" : undefined}
              class={active ? "nav-link nav-link--active" : "nav-link"}
            >
              {l.label}
            </a>
          );
        })}
      </div>
    </div>
  </nav>

  <hr class="hero-line" />

  <!-- mantém SEU script de auth aqui embaixo, sem mudar -->
</header>
