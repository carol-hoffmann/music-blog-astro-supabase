---
export const prerender = false;
import BaseLayout from "../../layouts/BaseLayout.astro";

const postPageUrl = new URL("../../scripts/postPage.ts", import.meta.url);
---

<BaseLayout title="Post | Music Blog">
  <section class="page post-page">
    <div class="posts-hero-bg" aria-hidden="true">
      <img class="posts-hero-img" src="/images/hero5.jpg" alt="" loading="eager" />
      <div class="posts-hero-overlay"></div>
    </div>

    <div class="post-shell">
      <article class="post-panel">
        <p class="meta post-back">
          <a href="/posts">← Back to posts</a>
        </p>

        <h1 id="title" class="post-title">Loading...</h1>
        <p id="date" class="meta post-date"></p>

        <div id="content" class="post-content"></div>

        <div id="ownerActions" class="post-actions" style="display:none;">
          <a class="btn" id="editBtn" href="#">Edit</a>
          <button class="btn" id="deleteBtn" type="button">Delete</button>
        </div>

        <p id="msg" class="meta post-msg"></p>
      </article>

      <section class="post-panel">
        <div class="comments-head">
          <h2 class="comments-title">Comments</h2>
        </div>

        <div id="commentsWrap" class="comments-wrap">
          <p id="commentsMsg" class="meta">Loading comments...</p>
        </div>

        <div id="commentBox" class="comment-box" style="display:none;">
          <form id="commentForm" class="comment-form" novalidate>
            <label>
              Add a comment
              <textarea name="content" rows="3" required></textarea>
            </label>

            <div class="comment-actions">
              <button class="btn" type="submit">Post comment</button>
              <p id="commentFormMsg" class="meta"></p>
            </div>
          </form>
        </div>

        <p id="commentLoginMsg" class="meta" style="display:none;">
          You must be logged in to comment. <a href="/login">Login</a>
        </p>
      </section>
    </div>
  </section>

  <!-- ✅ isso vira um .js compilado no build -->
  <script type="module" src={postPageUrl.href}></script>
</BaseLayout>
